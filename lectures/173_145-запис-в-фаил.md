---
layout: default
title: "14.5 Запис в файл"
---

# 14.5 Запис в файл

Для запису байта в файл використовується метод WriteByte() . Нижче наведена його простіша форма.

void WriteByte(byte value)

Цей метод виконує запис в файл байта, що позначається параметром value. Якщо базовий потік не відкривається для виводу, то генерується виняток NotSupportedException. А якщо потік закрито , то генерується виняток ObjectDisposedException.

Для запису в файл цілого масиву байтів може бути викликаний метод Write(). Нижче наведена його загальна форма.

void Write(byte[] array, int offset, int count)

У методі Write() приймається спроба записати в файл кількість count байтів з масиву array,починаючи з елемента array[offset]. Він повертає кількість байтів, успішно записаних в файл. Якщо під час запису виникає помилка, то генерується винятокIOException. А якщо базовий потік не відкривається для ви воду, то генерується виняток NotSupportedException. Крім того, може бути згенеровано ряд інших винятків. Вам, ймовірно, відомо, що при виводі в файл виводимі дані часто записуються на конкретному фізичному пристрої не одразу. Замість цього вони буферизуються на рівні операційної системи до тих пір, поки не накопичиться достатній обсяг даних , щоб записати їх одразу одним блоком. Це підвищує ефективність системи. Так, на диску файли організовані по секторах розміром від 128 байтів і більше. Тому виводимі дані зазвичай буферизуються до тих пір, поки не з'явиться можливість записати на диск одразу весь сектор. Але якщо дані потрібно записати на фізичний пристрій без попереднього накопичення в буфері, то для цього можна викликати метод Flush.

void Flush()

При невдалих наслідках цієї операції генерується виняток IOException. Якщо потік закритий, то генерується виняток ObjectDisposedException. Після завершення виводу в файл слід закрити його за допомогою методу Close(). Цим гарантується, що будь-які виведені дані, що залишилися в дисковому буфері, будуть записані на диск. У цьому випадку не потрібно викликати метод Flush()перед закриттям файлу.

Лістинг 14.03 - Записати дані у файл

using System;

using System.IO;

class WriteToFile

{

static void Main(string[] args)

{

FileStream fout = null;

try

{

// Відкрити вихідний файл.

fout = new FileStream("test.txt", FileMode.CreateNew);

// Записати весь англійський алфавіт у файл.

for (char с = 'А'; с <= 'Z'; C++)

fout.WriteByte((byte)с);

}

catch (IOException exc)

{

Console.WriteLine("Помилка введеннявиведення: " + exc.Message);

}

finally

{

if (fout != null) fout.Close();

}

}

}

У даній програмі спочатку створюється вихідний файл під назвою test.txt за допомогою перераховуваного значення FileMode.CreateNew. Це означає, що файл з таким самим ім'ям не повинен вже існувати. (У протилежному випадку генерується виняток IOException.) Після відкриття вихідного файлу в нього записуються прописні букви англійського алфавіту. Після завершення цієї програми вміст файлу test.txt відображається наступним чином. ABCDEFGHIJKLMNOPQRSTUVWXYZ.
