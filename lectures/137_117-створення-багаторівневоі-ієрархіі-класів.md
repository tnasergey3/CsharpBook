---
layout: default
title: "11.7 Створення багаторівневої ієрархії класів"
---

# 11.7 Створення багаторівневої ієрархії класів

У раніше наведених прикладах програм використовувалися прості ієрархії класів , що складалися лише з базового і похідного класів. Але в C# можна але також будувати ієрархії, що складаються з будь-якої кількості рівнів наслідування. Як зазначалося вище, багаторівнева ієрархія ідеально підходить для використання одного похідного класу як базового для іншого похідного класу. Так, якщо є класи, А, Ві С, то клас С може успадковувати від класу В, а той, в свою чергу, від класу А. У такому випадку кожен похідний клас успадковує ха рактерні особливості всіх своїх базових класів. Зокрема, клас С успадковує всі члени класів Ві А. Для того щоб показати , наскільки корисною може бути багаторівнева ієрархія класів, розглянемо наступний приклад програми. У ній похідний клас Triangle служить в якості базового для створення іншого похідного клас у —ColorTriangle. При цьому клас ColorTriangle успадковує всі характерні осо бливості, а по суті, члени класів Triangleі TwoDShape, до яких додається поле color, що містить колір трикутника.

Лістинг 11.12 - Приклад побудови багаторівневої ієрархії класів

class TwoDShape

{

double pri_width;

double pri_height;

// Конструктор, використовуваний за замовчуванням.

public TwoDShape()

{

Width = Height = 0.0;

}

// Конструктор для класу TwoDShape.

public TwoDShape(double w, double h)

{

Width = w;

Height = h;

}

// Побудувати об'єкт з однаковою шириною і висотою.

public TwoDShape(double х)

{

Width = Height = x;

}

// Властивості ширини і висоти об'єкта.

public double Width

{

get { return pri_width; }

set { pri_width = value < 0 ? value: value; }

}

public double Height

{

get { return pri_height; }

set { pri_height = value < 0 ? value: value; }

}

public void ShowDim()

{

Console.WriteLine("Ширина і висота дорівнюють " +

Width + " і " + Height);

}

}

// Клас для трикутників, похідний від класу TwoDShape.

class Triangle : TwoDShape

{

string Style; // закритий член класу

/* Конструктор, використовується за замовчуванням.

Автоматично викликає конструктор, доступний за

замовчуванням в класі TwoDShape. */

public Triangle()

{

Style = "null";

}

// Конструктор.

public Triangle(string s, double w, double h) : base(w, h)

{

Style = s;

}

// Побудувати рівнобедрений трикутник.

public Triangle(double x) : base(x)

{

Style = "рівнобедрений";

}

// Повернути площу трикутника.

public double Area()

{

return Width * Height / 2;

}

// Показати тип трикутника.

public void ShowStyle()

{

Console.WriteLine("Трикутник " + Style);

}

}

// Розширити клас Triangle.

class ColorTriangle : Triangle

{

string color;

public ColorTriangle(string c, string s,

double w, double h) : base(s, w, h)

{

color = c;

}

// Показати колір трикутника.

public void ShowColor()

{

Console.WriteLine("Колір " + color);

}

}

Завдяки успадкуванню в класі ColorTriangle можуть використовуватися визначені раніше класи Triangle і TwoDShape , до елементів яких додається лише та інформація, яка потрібна для конкретного застосування даного класу. У цьому відчастина і полягає цінність успадкування, оскільки воно дозволяє повторне використання коду. Наведений вище приклад демонструє ще одне важливе положення: ключове слово base завжди позначає посилання на конструктор найближчого за ієрархією базового класу. Так, ключове слово base в класі ColorTriangle означає виклик конструктора з класу Triangle, а ключове слово base в класі Triangle — виклик конструктора з класу TwoDShape. Якщо ж в ієрархії класів конструктору базо вого класу потрібні параметри, то всі похідні класи повинні надати ці параметри вгору по ієрархії, незалежно від того, потрібні вони самому похід ному класу чи ні.
