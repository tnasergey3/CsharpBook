---
layout: default
title: "11.14 Упаковка і розпакування"
---

# 11.14 Упаковка і розпакування

Як пояснювалося вище, всі типи в С#, включаючи прості типи значень, є похідними від класу object . Отже, посиланням типу object можна скористатися для звернення до будь-якого іншого типу, включаючи типи значень. Коли посилання на об'єкт класу object використовується для звернення до типу значення, такий процес називається упаковкою. Упаковка призводить до того, що значення простого типу зберігається в екземплярі об'єкта, тобто " упаковується " в об'єкті , який потім використовується як будь-який інший об'єкт.

Але в будь-якому випадку упаковка відбувається автоматично. Для цього достатньо присвоїти значення змінній посиланняного типу object , а про решту піклується компілятор С#. Розпакування представляє собою процес вилучення упакованого значення з об'єкта. Це робиться за допомогою явного приведення типу посилання на об'єкт класу object до відповідного типу значення. Спроба розпакувати об'єкт в інший тип може призвести до помилки під час виконання. Нижче наведено простий приклад, що демонструє упакування і розпакування.

Лістинг 11.21 - Простий приклад упакування і розпакування

class BoxingDemo

{

static void Main()

{

int x;

object obj;

х = 10;

obj = x; // упакувати значення змінної х в об'єкт

int у = (int)obj; // розпакувати значення з об'єкта, доступного за

// посиланням obj, в змінну типу int

Console.WriteLine(у);

}

}

У цьому прикладі коду виводиться значення 10. Зверніть увагу на те, що значе ня змінної х упаковується в об'єкт простим його присвоєнням змінній obj, яка посилається на цей об'єкт. А потім це значення вилучається з об'єкта, до ступного за його посиланням obj, і далі перетворюється до типу int. Нижче наведено ще один, більш цікавий приклад упакування. У даному випадку значення типу int передається як аргумент методу Sqr(), який, в свою чергу, приймає параметр типу object.

Лістинг 11.22 - Приклад упаковки при передачі значення методу.

class BoxingDemo

{

static void Main()

{

int x;

x = 10;

Console.WriteLine("Значення x дорівнює: " + x);

// значення змінної x автоматично упаковується

// коли воно передається методу Sqr().

х = BoxingDemo.Sqr(х);

Console.WriteLine("Значення x в квадраті дорівнює: " + х);

}

static int Sqr(object о)

{

return (int)о * (int)о;

}

}

У даному прикладі значення змінної х автоматично упаковується при перед ачі методу Sqr(). Упаковка і розпакування дозволяють повністю уніфікувати систему типів в С#. Завдяки тому, що всі типи є похідними від класу object, посилання на значення будь-якого типу може бути просто присвоєне змінній посиланняного типу object, а все інше візьмуть на себе упаковка і розпакування. Більше того, методи класу object показуються доступними всім типам, оскільки вони є по хідними від цього класу.
