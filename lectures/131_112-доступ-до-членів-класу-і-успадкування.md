---
layout: default
title: "11.2 Доступ до членів класу і успадкування"
---

# 11.2 Доступ до членів класу і успадкування

Як пояснювалося в главі 8, члени класу часто оголошуються закритими, щоб виключити їх несанкціоноване або незаконне використання. Але наслідування класу не скасовує обмеження, накладені на доступ до закритих членів класу. Тому, якщо всі члени його базового класу входять до похідного класу, вони все одно залишаються недоступними ті члени базового класу, які є закритими. Так, якщо зробити змінні класу TwoDShape закритими, вони стануть недоступними в класі Triangle , як показано нижче.

Лістинг 11.3 - Доступ до закритих членів класу не успадковується.

// Клас для двовимірних об'єктів.

class TwoDShape

{

double Width; // тепер це закрита змінна

double Height; // тепер це закрита змінна

public void ShowDim()

{

Console.WriteLine("Ширина і висота дорівнюють " +

Width + " і " + Height);

}

}

// Клас Triangle, похідний від класу TwoDShape.

class Triangle : TwoDShape

{

public string Style; // тип трикутника

// Повернути площу трикутника.

public double Area()

{

return Width * Height / 2; // Помилка, доступ до закритого

// члену класу заборонено

}

// Показати тип трикутника.

public void ShowStyle()

{

Console.WriteLine("Трикутник " + Style);

}

}

Клас Triangle не буде компілюватися, оскільки звертатися до змінних Width і Height з методу Area() заборонено. А оскільки змінні Width і Height тепер є закритими, то вони доступні лише для інших членів свого класу, але не для членів похідних класів.

На перший погляд, обмеження на доступ до приватних членів базового класу з по хідного класу здається непереборним, оскільки воно не дає в багатьох випадках можливості користуватися приватними членами цього класу. Але насправді це не так. Для подолання даного обмеження в C# передбачені різні способи. Один з них полягає у використанні захищених ( protected ) членів класу, які розглядаються в наступному розділі, а другий - у застосуванні відкритих властивостей для доступу до закритих даних.

Як пояснювалося в попередньому розділі, властивість дозволяє керувати доступом до змінної екземпляра. Наприклад, за допомогою властивості можна накласти обмеження на доступ до значення змінної або зробити її доступною тільки для читання. Так, якщо зробити властивість відкритою, але оголосити її базову змінну закритою, то цією властивістю можна буде скористатися в похідному класі, але не можна буде отримати безпосередній доступ до її базової закритої змінної. Нижче наведено варіант класу TwoDShape, в якому змінні Widthі Height перетворені на властивості. Під час виконання в цьому класі перевіряється, чи є позитивними значення властивостей Widthі Height. Це, наприклад, дає можливість вказувати властивості Widthі Heightяк координати форми в будь-якому квадранті прямокутної системи координат, не отримуючи наперед їх абсолютні значення.

Лістинг 11.4 - Як використовувати відкриті властивості

// Клас для двовимірних об'єктів.

class TwoDShape

{

double pri_width; // тепер це закрита змінна

double pri_height; // тепер це закрита змінна

// Властивості ширини і висоти двовимірного об'єкта.

public double Width

{

get { return pri_width; }

set { pri_width = value < 0 ? value: value; }

}

public double Height

{

get { return pri_height; }

set { pri_height = value < 0 ? value: value; }

}

public void ShowDim()

{

Console.WriteLine("Ширина і висота дорівнюють " +

Width + " і " + Height);

}

}

// Клас для трикутників, похідний від

// класу TwoDShape.

class Triangle : TwoDShape

{

public string Style; // тип трикутника

// Повернути площу трикутника.

public double Area()

{

return Width * Height / 2;

}

// Показати тип трикутника.

public void ShowStyle()

{

Console.WriteLine("Трикутник " + Style);

}

}

У цьому варіанті властивості Width і Height надають доступ до закритих членів pri_width і pri_height класу TwoDShape , в яких фактично зберігаються значення ширини і висоти двовимірного об'єкта. Отже, значення членів pri_width і pri_height класу TwoDShape можуть бути встановлені і отримані за допомогою відповідних відкритих властивостей, незважаючи на те, що самі ці члени за- лишаються закритими. Базові та похідні класи іноді також називаються суперкласом та підкласом. Ці терміни походять з практики програмування на Java. Те, що в Java називається суперкласом, в C# позначається як базовий клас. А те, що в Java називається підкласом, в C# позначається як похідний клас. Обидва ряди термінів часто застосовуються до класу в обох мовах програмування, але в цій книзі продовжують використовуватися загальноприйняті в C# терміни базового та похідного класів, які звичайно використовуються й в C++.
