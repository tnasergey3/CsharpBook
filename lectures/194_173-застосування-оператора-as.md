---
layout: default
title: "17.3 Застосування оператора as"
---

# 17.3 Застосування оператора as

Іноді потрібно виконати приведення типів під час виконання, але не генерувати виняток, якщо це приведення буде невдалим, що цілком можливо при приведенні типів. Для цієї цілі слугує оператор as, який має наступну загальну форму:

вираз as тип

де вираз означає окремий вираз, перетворений у вказаний тип. Якщо результат такого перетворення є успішним, то повертається посилання на тип , інакше — порожнє посилання. Оператор as може використовуватися тільки для перетворення посилань, ідентичності, упаковки, розпаковки. У деяких випадках оператор asможе служити зручною альтернативою оператору is . Як приклад розглянемо наступну програму, в якій оператор is використовується для запобігання неправильного приведення типів.

Лістинг 17.2 - Використовувати оператор is для запобігання неправильного приведення типів

using System;
class А {}
class В : А {}
class CheckCast {
    static void Main() {
        A a = new A();
        В b = new В();
// Перевірити, чи можна привести а до типу В.
        if(a is В) // якщо так, то виконати приведення типів
            b = (В) а;
        else // якщо ні, то пропустити приведення типів
            b = null;
        if(b==null)
            Console.WriteLine("Приведення типів b = (В) НЕ допустимо.");
        else
            Console.WriteLine("Приведення типів b = (В) допустимо.");
    }
}

Ця програма дає наступний результат. Приведення типів b = (В) НЕ допустимо.

Як випливає з результату виконання наведеної вище програми, тип об'єкта а несумісний з типом В , тому його приведення до типу В недопустиме і запобігається в умовному операторі if. Але таку перевірку доводиться виконувати в два етапи. Спочатку потрібно переконатися в обґрунтованості операції приведення типів, а потім виконати її. Обидва етапи можна об'єднати в один за допомогою оператора as, як показує наведена нижче програма.

Лістинг 17.3 - Показати застосування оператора as

using System;
class A {}
class В : A {}
class CheckCast {
    static void Main() {
        A a = new A();
        В b = new В();
        b = a as В; // виконати приведення типів, якщо це можливо
        if(b==null)
            Console.WriteLine("Приведення типів b = (В) НЕ допустимо.");
        else
            Console.WriteLine("Приведення типів b = (В) допустимо.");
    }
}

Ця програма дає попередній результат. Приведення типів b = (В) НЕ допустимо.

У цьому варіанті програми в одному і тому ж операторі as спочатку перевіряється обґрунтованість операції приведення типів, а потім виконується сама операція при приведенні типів, якщо вона допустима.
