---
layout: default
title: "11.1 Основи успадкування"
---

# 11.1 Основи успадкування

Підтримка успадкування в C# полягає в тому, що при оголошенні одного класу можна вводити інший клас. Для цього при оголошенні похідного класу вказується базовий клас. Розглянемо спочатку простий приклад. Нижче наведений клас TwoDShape, що містить ширину і висоту двовимірного об'єкта, наприклад квадрата, прямо кутника, трикутника тощо.

Лістинг 11.01 - Клас для двовимірних об'єктів.

class TwoDShape

{

public double Width;

public double Height;

public void ShowDim()

{

Console.WriteLine("Ширина і висота дорівнюють " +

Width + " і " + Height);

}

}

Клас TwoDShape може стати базовим, тобто вихідною точкою для створення класів, що описують конкретні типи двовимірних об'єктів. Наприклад, у наведеній нижче програмі клас TwoDShapeвикористовується для породження похідного класу Triangle. Зверніть особливу увагу на оголошення класу Triangle.

Лістинг 11.2 - Приклад простої ієрархії класів.

// Клас для двовимірних об'єктів.

class TwoDShape

{

public double Width;

public double Height;

public void ShowDim()

{

Console.WriteLine("Ширина і висота дорівнюють " +

Width + " і " + Height);

}

}

// Клас Triangle, похідний від класу TwoDShape.

class Triangle : TwoDShape

{

public string Style; // тип трикутника

// Повернути площу трикутника.

public double Area()

{

return Width * Height / 2;

}

// Показати тип трикутника.

public void ShowStyle()

{

Console.WriteLine("Трикутник " + Style);

}

}

class Shapes

{

static void Main()

{

Triangle t1 = new Triangle();

Triangle t2 = new Triangle();

t1.Width = 4.0;

t1.Height = 4.0;

t1.Style = "рівнобедрений";

t2.Width = 8.0;

t2.Height = 12.0;

t2.Style = "прямокутний";

Console.WriteLine("Інформація про об'єкт t1: ");

t1.ShowStyle();

t1.ShowDim();

Console.WriteLine("Площа дорівнює " + t1.Area());

Console.WriteLine();

Console.WriteLine("Інформація про об'єкт t2: ");

t2.ShowStyle();

t2.ShowDim();

Console.WriteLine("Площа дорівнює " + t2.Area());

}}

У класі Triangle створюється особливий тип об'єкта класу TwoDShape (у цьому випадку - трикутник). Крім того, до класу Triangle входять всі члени класу TwoDShape, до яких, зокрема, додаються методи Area() і ShowStyle(). Таким чином, опис типу трикутника зберігається в змінній Style, метод Area() розраховує і повертає площу трикутника, а метод ShowStyle() відображає тип трикутника. Зверніть увагу на синтаксис, що використовується в класі Triangle для успадкування класу TwoDShape .

class Triangle : TwoDShape {

Цей синтаксис може бути узагальнений. Кожного разу, коли один клас успадковує від іншого, після імені базового класу вказується ім'я похідного класу, розділене двокрапкою. У C# синтаксис успадкування класу дивовижно простий і зручний у використанні. У класі Triangle включаються всі члени його базового класу TwoDShape , тому у ньому змінні Width і Height доступні для методу Area() . Крім того, об'єкти t1 і t 2 у методі Main() можуть безпосередньо звертатися до змінних Width і Height , ніби вони є членами класу Triangle . На рис. 11.1 схематично показано, як клас TwoDShape вводиться в клас Triangle .

Рисунок 11.1 - Схематичне зображення класу Triangle

Незважаючи на те, що клас TwoDShape є базовим для класу Triangle, в той же час він є абсолютно незалежним і самодостатнім класом. Якщо клас є базовим для похідного класу, це зовсім не означає, що він не може бути використаний самостійно. Наприклад, наступний фрагмент коду вважається повністю допустимим.

TwoDShape shape = new TwoDShape();

shape.Width = 10;

shape.Height = 20;

shape.ShowDim();

Звичайно, об'єкт класу TwoDShape ніяк не пов'язаний з будь-яким з класів, похідних від класу TwoDShape , і взагалі не має до них доступу. Нижче наведено загальна форма оголошення класу, що успадковується від базового класу.

class ім'я_похідного_класу : ім'я_базового_класу {

// тіло класу

}

Для будь-якого похідного класу можна вказати лише один базовий клас. У C# не передбачено успадкування кількох базових класів в одному похідному класі. (У цьому відношенні C# відрізняється від C++, де допускається успадкування кількох базових класів. Цю обставину слід враховувати при перенесенні коду C++ в С#.) Однак можна створити ієрархію успадкування, в якій похідний клас стає базовим для іншого похідного класу. (Звичайно, жоден з класів не може бути базовим для самого себе як безпосередньо, так і посередньо.) Але в будь-якому випадку похідний клас успадковує всі члени свого базового класу, включаючи змінні екземпляра, методи, властивості та індексатори.

Головна перевага успадкування полягає в наступному: як тільки буде створений базовий клас, в якому визначені загальні для багатьох об'єктів атрибу ти, його можна використовувати для створення будь-якої кількості більш конкретних похідних класів. А в кожному похідному класі може бути точно впорядкована своя власна класифікація. Як приклад нижче наведено ще один клас, похідний від класу TwoDShape і інкапсулюючий прямокутники.
