---
layout: default
title: "6.7 Оператор циклу foreach"
---

# 6.7 Оператор циклу foreach

Як зазначалося в розділі 5, в мові C# визначений оператор циклу foreach, але його розгляд був відкладений до більш підходящого моменту. Тепер цей момент настав. Оператор foreach використовується для циклічного звернення до елементів колекції , що представляє собою групу об'єктів. У C# визначено кілька видів колекцій, кожна з яких є масивом. Нижче наведена загальна форма оператора циклу foreach.

foreach (тип ім'я_змінної_циклу in колекція ) оператор;

Тут тип ім'я_змінної_циклу означає тип і ім'я змінної управління циклом, яка отримує значення наступного елемента колекції на кожному кроці виконання циклу foreach. Колекція означає циклічно опитувану колекцію, яка тут і далі представляє собою масив. Отже, тип змінної циклу повинен відповідати типу елемента масиву. Крім того, тип може позначатися ключовим словом var . У цьому випадку компілятор визначає тип змінної циклу, виходячи з типу елемента масиву. Це може бути корисним для роботи з певного роду запитами, як буде показано далі. Але, як правило, тип вказується явно.

Оператор циклу foreach діє наступним чином. Коли цикл починається, перший елемент масиву вибирається і присвоюється змінній циклу. На кожному наступному кроці ітерації вибирається наступний елемент масиву, який зберігається в змінній циклу. Цикл завершується, коли всі елементи масиву стануть вибраними. Отже, оператор foreach циклічно опитує масив по окремим його елементам від початку до кінця.

Слід, однак, мати на увазі, що змінна циклу в операторі foreach служить тільки для читання. Це означає, що, присвоюючи цій змінній нове значення, не можна змінити вміст масиву.

Нижче наведено простий приклад застосування оператора циклу foreach. У цьому прикладі спочатку створюється цілочисельний масив і задається ряд його початкових значень, а потім ці значення виводяться, а по ходу обчислюється їх сума (лістинг 6.15).

Лістинг 6.15 – Використання оператора циклу foreach

// Використання оператора циклу foreach.

using System;

class ForeachDemo

{

static void Main()

{

int sum = 0;

int[] nums = new int[10];

// Задати початкові значення елементів масиву nums.

for (int i = 0; i < 10; i++)

nums[i] = i;

//  Використовувати цикл foreach для виведення значень

// елементів масиву та підрахунку їх суми.

foreach (int x in nums)

{

Console.WriteLine("Значення елемента дорівнює: " + x);

sum += x;

}

Console.WriteLine("Сума дорівнює: " + sum);

}

}

Виконання наведеного вище коду дає наступний результат.

Значення елемента дорівнює: 0

Значення елемента дорівнює: 1

Значення елемента дорівнює: 2

Значення елемента дорівнює: 3

Значення елемента дорівнює: 4

Значення елемента дорівнює: 5

Значення елемента дорівнює: 6

Значення елемента дорівнює: 7

Значення елемента дорівнює: 8

Значення елемента дорівнює: 9

Сума дорівнює: 45

Як бачите, оператор foreach циклічно опитує масив за порядком індексування від першого до останнього його елемента.

Незважаючи на те, що цикл foreach повторюється доти, поки не будуть опитані всі елементи масиву, його можна завершити передчасно, скориставшись оператором break. Нижче наведено приклад програми, в якій сумуються лише п'ять перших елементів масиву nums (лістинг 6.16).

Лістинг 6.16 – Використання оператора break

// Використовувати оператор break

// для передчасного завершення циклу foreach.

using System;

class ForeachDemo

{

static void Main()

{

int sum = 0;

int[] nums = new int[10];

//  Задати початкові значення елементів масиву nums.

for (int i = 0; i < 10; i++)

nums[i] = i;

// Використовувати цикл foreach для виведення значень

// елементів масиву та підрахунку їх суми.

foreach (int x in nums)

{

Console.WriteLine("Значення елемента дорівнює: " + x);

sum += x;

if (x == 4) break; // перервати цикл, як тільки

// індекс масиву досягне 4

}

Console.WriteLine("Сума перших 5 елементів: " + sum);

}

}

Ось який результат дає виконання цієї програми.

Значення елемента дорівнює: 0

Значення елемента дорівнює: 1

Значення елемента дорівнює: 2

Значення елемента дорівнює: 3

Значення елемента дорівнює: 4

Сума перших 5 елементів: 10

Зовсім очевидно, що цикл foreach завершується після вибору та виведення значення п'ятого елемента масиву.

Оператор циклу foreach можна також використовувати для циклічного звернення до елементів багатовимірного масиву. У цьому випадку елементи багатовимірного масиву повертаються у порядку слідування рядків від першого до останнього, як показує наведений нижче приклад програми (лістинг 6.17).

Лістинг 6.17 – Використання оператора циклу foreach

// Використовувати оператор циклу foreach

// для доступу до двовимірного масиву.

using System;

class ForeachDemo2

{

static void Main()

{

int sum = 0;

int[,] nums = new int[3, 5];

// Задати початкові значення елементів масиву nums.

for (int i = 0; i < 3; i++)

for (int j = 0; j < 5; j++)

nums[i, j] = (i + 1) * (j + 1);

//  Використовувати цикл foreach для виведення значень

// елементів масиву та підрахунку їх суми.

foreach (int x in nums)

{

Console.WriteLine("Значення елемента дорівнює: " + x);

sum += x;

}

Console.WriteLine("Сума дорівнює: " + sum);

}

}

Виконання цієї програми дає наступний результат.

Значення елемента дорівнює: 1

Значення елемента дорівнює: 2

Значення елемента дорівнює: 3

Значення елемента дорівнює: 4

Значення елемента дорівнює: 5

Значення елемента дорівнює: 2

Значення елемента дорівнює: 4

Значення елемента дорівнює: 6

Значення елемента дорівнює: 8

Значення елемента дорівнює: 10

Значення елемента дорівнює: 3

Значення елемента дорівнює: 6

Значення елемента дорівнює: 9

Значення елемента дорівнює: 12

Значення елемента дорівнює: 15

Сума дорівнює: 90

Оператор foreach дозволяє циклічний доступ до масиву тільки в певному порядку: від початку до кінця масиву, тому його застосування, на перший погляд, здається обмеженим. Але насправді це не так. У багатьох алгоритмах, найпоширенішим з яких є алгоритм пошуку, потрібний саме такий механізм. Нижче наведено програму, в якій цикл foreach використовується для пошуку певного значення в масиві. Як тільки це значення буде знайдено, цикл буде припинено (лістинг 6.18).

Лістинг 6.18 – Пошук у масиві за допомогою оператора циклу foreach

// Пошук у масиві за допомогою оператора циклу foreach.

using System;

class Search

{

static void Main()

{

int[] nums = new int[10];

int val;

bool found = false;

// Задати початкові значення елементів масиву nums.

for (int i = 0; i < 10; i++)

nums[i] = i;

val = 5;

// Використовувати цикл foreach для пошуку заданого

// значення в масиві nums.

foreach (int x in nums)

{

if (x == val)

{

found = true;

break;

}

}

if (found)

Console.WriteLine("Значення знайдено!");

}

}

При виконанні цієї програми отримується наступний результат.

Значення знайдено!

Оператор циклу foreach ідеально підходить для такого застосування, оскільки при пошуку в масиві доводиться аналізувати кожен його елемент. До інших прикладів застосування оператора циклу foreach відноситься обчислення середнього, пошук мінімального або максимального значення серед ряду заданих значень, виявлення дублікатів і т.д. Як буде показано далі, оператор циклу foreach виявляється особливо корисним для роботи з різними типами колекцій.
