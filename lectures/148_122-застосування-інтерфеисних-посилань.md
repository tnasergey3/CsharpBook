---
layout: default
title: "12.2 Застосування інтерфейсних посилань"
---

# 12.2 Застосування інтерфейсних посилань

Як це не здається дивним, але в C# дозволяється оголошувати змінні посилання на інтерфейсний тип, тобто змінні посилання на інтерфейс. Така змінна може посилатися на будь-який об'єкт, що реалізує його інтерфейс. При виклику методу для об'єкта за допомогою інтерфейсного посилання виконується його варіант, реалізований в класі даного об'єкта. У наведеному нижче прикладі програми демонструється застосування інтер фейсного посилання. У цій програмі змінна посилання на інтерфейс використовується з метою викликати методи для об'єктів обох класів — ByTwosі Primes. Для ясності в даному прикладі показані всі частини програми, зібрані в єдиний файл.

Лістинг 12.3 - Приклад застосування інтерфейсних посилань

// Визначити інтерфейс.

public interface ISeries

{

int GetNext(); // повернути наступне за порядком число

void Reset(); // перезапустити

void SetStart(int х); // задати початкове значення

}

// Використовувати інтерфейс ISeries для реалізації процесу

// генерування послідовного ряду чисел, в якому кожне

// наступне число на два більше попереднього.

class ByTwos : ISeries

{

int start;

int val;

public ByTwos()

{

start = 0;

val = 0;

}

public int GetNext()

{

val += 2;

return val;

}

public void Reset()

{

val = start;

}

public void SetStart(int x)

{

start = x;

val = start;

}

}

class Primes : ISeries

{

int start;

int val;

public Primes()

{

start = 2;

val = 2;

}

public int GetNext()

{

int i, j;

bool isprime;

val++;

for (i = val; i < 1000000; i++)

{

isprime = true;

for (j = 2; j <= i / j; j++)

{

if ((i % j) == 0)

{

isprime = false;

break;

}

}

if (isprime)

{

val = i;

break;

}

}

return val;

}

public void Reset()

{

val = start;

}

public void SetStart(int x)

{

start = x;

val = start;

}

}

class SeriesDemo2

{

static void Main()

{

ByTwos twoOb = new ByTwos();

Primes primeOb = new Primes();

ISeries ob;

for (int i = 0; i < 5; i++)

{

ob = twoOb;

Console.WriteLine("Наступне парне число дорівнює " + ob.GetNext());

ob = primeOb;

Console.WriteLine("Наступне просте число " + "дорівнює " + ob.GetNext());

}

}

}

Ось до якого результату призводить виконання цієї програми:

Наступне парне число дорівнює 2

Наступне просте число дорівнює 3

Наступне парне число дорівнює 4

Наступне просте число дорівнює 5

Наступне парне число дорівнює 6

Наступне просте число дорівнює 7

Наступне парне число дорівнює 8

Наступне просте число дорівнює 11

Наступне парне число дорівнює 10

Наступне просте число дорівнює 13

У методі Main() змінна ob оголошується для посилання на інтерфейс ISeries . Це означає, що в ній можуть зберігатися посилання на об'єкт будь-якого класу, що реалізує даний інтерфейс ISeries . У даному випадку вона служить для посилання на об'єкти twoOb і primeOb класів ByTwos і Primes відповідно, в яких реалізований інтерфейс ISeries. І ще одне зауваження: змінній посилання на інтерфейс доступні тільки методи, оголошені в його інтерфейсі. Тому інтерфейсне посилання не можна використовувати для доступу до будь-яких інших змінних і методів, які не підтримуються об'єктом класу , що реалізує цей інтерфейс.
